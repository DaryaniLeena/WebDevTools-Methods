{"version":3,"sources":["webpack://express/./src/services.js","webpack://express/./src/todo.js","webpack://express/webpack/bootstrap","webpack://express/webpack/runtime/define property getters","webpack://express/webpack/runtime/hasOwnProperty shorthand","webpack://express/webpack/runtime/make namespace object","webpack://express/webpack/startup"],"names":["checkLoginStatus","fetch","method","Promise","reject","error","then","response","ok","json","err","performLogin","username","headers","Headers","body","JSON","stringify","todos","addLogin","disableButtonIfNoInput","listEl","document","querySelector","addAbilityToAddItems","addAbilityToDeleteItems","addAbilityToCompleteItems","enablelogout","updateStatus","message","status","innerText","convertError","pollingId","refresh","userInfo","showContent","renderTodos","setTimeout","showLogin","clearTimeout","classList","add","remove","addEventListener","usernameEl","value","console","log","errMsgs","name","ans","html","map","todo","done","id","task","join","innerHTML","e","target","contains","itemid","dataset","disabled"],"mappings":"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","file":"todo.js","sourcesContent":["export const checkLoginStatus = function () {\n  return fetch(\"/session\", {\n    method: \"GET\",\n  })\n    .catch(() => {\n      return Promise.reject({ error: \"network-error\" });\n    })\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      return response.json().then((err) => Promise.reject(err));\n    });\n};\n\nexport const performLogin = function (username) {\n  return fetch(\"/session\", {\n    method: \"POST\",\n    headers: new Headers({\n      \"content-type\": \"application/json\",\n    }),\n    body: JSON.stringify({ username }),\n  })\n    .catch(() => {\n      return Promise.reject({ error: \"network-error\" });\n    })\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      return response.json().then((err) => Promise.reject(err));\n    });\n};\n\n//   export const enablelogout= function() {\n//     return fetch(`/session`, {\n//         method: 'POST',\n//       })\n//       .catch( () => Promise.reject( { error: 'network-error' }) )\n//       .then(convertError)\n//       .then( ()=> {\n//           return\n//       })\n//       .catch( err => {\n//         updateStatus(errMsgs[err.error] || err.error);\n//       });\n//     }\n","import { checkLoginStatus, performLogin } from \"./services\";\nlet todos = []; // TODO - should be object, not array\n\naddLogin();\ndisableButtonIfNoInput();\nconst listEl = document.querySelector(\"#todo-app .todos\");\naddAbilityToAddItems();\naddAbilityToDeleteItems();\naddAbilityToCompleteItems();\nenablelogout();\n\nfunction updateStatus(message) {\n  status.innerText = message;\n}\n\nfunction convertError(response) {\n  if (response.ok) {\n    return response.json();\n  }\n  return response.json().then((err) => Promise.reject(err));\n}\n\n// Check for login\nlet pollingId;\nconst refresh = () => {\n  checkLoginStatus()\n    .then((userInfo) => {\n      showContent();\n      todos = userInfo.todos;\n      renderTodos(todos);\n    })\n    .then(() => {\n      pollingId = setTimeout(refresh, 5000);\n    })\n    .catch((error) => {\n      showLogin();\n      clearTimeout(pollingId);\n    });\n};\n\nrefresh();\n\n// TODO: Move these HTML-changing functions to an import from another file\nfunction showContent() {\n  document.querySelector(\"#todo-app .login\").classList.add(\"hidden\");\n  document.querySelector(\"#todo-app .logged-in\").classList.remove(\"hidden\");\n}\n\nfunction showLogin() {\n  document.querySelector(\"#todo-app .login\").classList.remove(\"hidden\");\n  document.querySelector(\"#todo-app .logged-in\").classList.add(\"hidden\");\n}\n\nfunction addLogin() {\n  document\n    .querySelector(\"#todo-app .login button\")\n    .addEventListener(\"click\", () => {\n      const usernameEl = document.querySelector(\"#todo-app .login input\");\n      const username = usernameEl.value;\n      // call service\n      performLogin(username)\n        .then((userInfo) => {\n          showContent();\n          todos = userInfo.todos;\n          renderTodos(todos);\n        })\n        .catch((err) => {\n          // fixme - show errors\n          console.log(err);\n        });\n    });\n}\n\nfunction enablelogout() {\n  document\n    .querySelector(\"#todo-app #logout-button\")\n    .addEventListener(\"click\", () => {\n      fetch(`/logout`, {\n        method: \"POST\",\n      })\n        .catch(() => Promise.reject({ error: \"network-error\" }))\n        .then(convertError)\n        .then(() => {\n          showLogin();\n          updateStatus(\"\");\n        })\n        .catch((err) => {\n          updateStatus(errMsgs[err.error] || err.error);\n        });\n    });\n}\n\nfunction addAbilityToAddItems() {\n  document\n    .querySelector(\"#todo-app .add-button\")\n    .addEventListener(\"click\", () => {\n      const name = document.querySelector(\"#todo-app .input-item\").value;\n      if (name) {\n        fetch(`/task`, {\n          method: \"POST\",\n          headers: new Headers({\n            \"content-type\": \"application/json\",\n          }),\n          body: JSON.stringify({ name }),\n        })\n          .catch(() => Promise.reject({ error: \"network-error\" }))\n          .then(convertError)\n          .then((ans) => {\n            document.querySelector(\"#todo-app .input-item\").value = \"\";\n            console.log(todos);\n            renderTodos(ans.todos);\n          })\n          .catch((err) => {\n            updateStatus(errMsgs[err.error] || err.error);\n          });\n      }\n    });\n}\n\nfunction renderTodos(todos) {\n  const html = todos\n    .map((todo) => {\n      return ` <li>\n        <span class=\"todo ${todo.done ? \"complete\" : \"\"}\" data-itemid=\"${\n        todo.id\n      }\">${todo.task}</span>\n        <span class=\"delete\" data-itemid=\"${todo.id}\">X</span>\n      </li> `;\n    })\n    .join(\"\\n\");\n  listEl.innerHTML = html;\n}\n\nfunction addAbilityToDeleteItems() {\n  listEl.addEventListener(\"click\", (e) => {\n    if (e.target.classList.contains(\"delete\")) {\n      const itemid = e.target.dataset.itemid;\n      fetch(`/task/${itemid}`, {\n        method: \"DELETE\"\n      })\n        .catch(() => Promise.reject({ error: \"network-error\" }))\n        .then(convertError)\n        .then((ans) => {\n          renderTodos(ans.todos);\n          updateStatus(\"\");\n        })\n        .catch((err) => {\n          updateStatus(errMsgs[err.error] || err.error);\n        });\n    }\n  });\n}\n\nfunction addAbilityToCompleteItems() {\n  listEl.addEventListener(\"click\", (e) => {\n    if (e.target.classList.contains(\"todo\")) {\n      const itemid = e.target.dataset.itemid;\n      fetch(`/task`, {\n        method: \"PATCH\",\n        headers: new Headers({\n            \"content-type\": \"application/json\",\n        }),\n        body: JSON.stringify({ itemid }),\n      })\n        .catch(() => Promise.reject({ error: \"network-error\" }))\n        .then(convertError)\n        .then((ans) => {\n          renderTodos(ans.todos);\n          updateStatus(\"\");\n        })\n        .catch((err) => {\n          updateStatus(errMsgs[err.error] || err.error);\n        });\n    }\n  });\n}\n\nfunction disableButtonIfNoInput() {\n  document\n    .querySelector(\"#todo-app .input-item\")\n    .addEventListener(\"input\", () => {\n      document.querySelector(\n        \"#todo-app .add-button\"\n      ).disabled = !document.querySelector(\"#todo-app .input-item\").value;\n    });\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module\n__webpack_require__(\"./src/todo.js\");\n// This entry module used 'exports' so it can't be inlined\n"],"sourceRoot":""}